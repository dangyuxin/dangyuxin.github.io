<!DOCTYPE html><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Dyxin - 学会与自己和解</title><meta name="author" content="dyx"><meta name="copyright" content="dyx"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="referrer" content="no-referrer"><meta property="og:type" content="website">
<meta property="og:title" content="Dyxin">
<meta property="og:url" content="http://dangyuxin.github.io/index.html">
<meta property="og:site_name" content="Dyxin">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://p3-pc.douyinpic.com/img/aweme-avatar/tos-cn-i-0813c001_oQVMIAnrIBEDAAPZbBAAQEAelfjxNss2b6F7Ef~c5_300x300.jpeg?from=2956013662">
<meta property="article:author" content="dyx">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://p3-pc.douyinpic.com/img/aweme-avatar/tos-cn-i-0813c001_oQVMIAnrIBEDAAPZbBAAQEAelfjxNss2b6F7Ef~c5_300x300.jpeg?from=2956013662"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://dangyuxin.github.io/index.html"><link rel="preconnect"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="/pluginsSrc/@fortawesome/fontawesome-free/css/all.min.css?v=6.5.1"><link rel="stylesheet" href="/pluginsSrc/@fancyapps/ui/dist/fancybox/fancybox.css?v=5.0.33" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":300},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: '/pluginsSrc/@egjs/infinitegrid/dist/infinitegrid.min.js?v=4.11.1',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Dyxin',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2024-05-12 14:21:27'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.2.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://p3-pc.douyinpic.com/img/aweme-avatar/tos-cn-i-0813c001_oQVMIAnrIBEDAAPZbBAAQEAelfjxNss2b6F7Ef~c5_300x300.jpeg?from=2956013662" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">46</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">15</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url('https://dyx-bucket.oss-cn-beijing.aliyuncs.com/2e339a3a385a4fcb89e102016eb40b61.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="Dyxin"><span class="site-name">Dyxin</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">Dyxin</h1><div id="site-subtitle"><span id="subtitle"></span></div><div id="site_social_icons"><a class="social-icon" href="https://github.com/dangyuxin" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="https://www.douyin.com/user/MS4wLjABAAAAabKSuqKzuKHByiNDDVLzJrbfB-5yw67yU4_9_9HcEjM" target="_blank" title="Douyin"><i class="fab fa-tiktok" style="color: #24292e;"></i></a><a class="social-icon" href="https://space.bilibili.com/173312348?spm_id_from=333.337.0.0" target="_blank" title="Bilibili"><i class="fab fa-bilibili" style="color: #24292e;"></i></a></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/posts/docker%E4%BD%BF%E7%94%A8%E4%B8%8E%E9%85%8D%E7%BD%AE.html" title="docker使用与配置">docker使用与配置</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-04-16T11:45:33.000Z" title="发表于 2024-04-16 19:45:33">2024-04-16</time></span></div><div class="content">Docker 环境配置
官网：https://www.docker.com - Mac、Windows、Linux
介绍：Docker 是一个开源的应用容器引擎，让开发者可以打包他们的应用以及依赖包到一个可移植的镜像中，然后发布到任何流行的 Mac、Linux或Windows操作系统的机器上，也可以实现虚拟化。容器是完全使用沙箱机制，相互之间不会有任何接口。总之它加快构建、共享和运行现代应用程序的速度。

一、基础安装1. 查看系统的内核版本1uname -r

14.18.0-80.11.2.el8_0.x86_64


uname -r
x86 64位系统，如果是32位是不能安装 docker 的

2. yum 更新到最新版本1sudo yum update

1234Last metadata expiration check: 1:15:10 ago on Sat 27 Nov 2021 04:22:53 PM CST.Dependencies resolved.Nothing to do.Complete!


sudo yum update
看到显示 Complete 就 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/posts/%E5%A6%82%E4%BD%95%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8%20Zsh.html" title="如何安装和使用 Zsh">如何安装和使用 Zsh</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-04-11T11:45:33.000Z" title="发表于 2024-04-11 19:45:33">2024-04-11</time></span></div><div class="content">在命令行世界中，Zsh（Z Shell）是一个备受推崇的替代品，它提供了比默认的 Bash shell 更多的功能和定制选项。Zsh具有强大的自动补全、语法高亮、主题定制等特性，让命令行体验更加愉快和高效。本篇博客将介绍如何安装和使用 Zsh，以及一些常用的定制技巧。
安装 Zsh
在 macOS 上安装macOS 用户可以使用 Homebrew 进行安装：

1brew install zsh


在 Linux 上安装

大多数 Linux 发行版都提供了 Zsh 的包管理安装方式。以 Ubuntu 为例：
1sudo apt install zsh

切换默认 Shell安装完成后，你需要将 Zsh 设置为默认的 Shell。运行以下命令：
1chsh -s $(which zsh)

然后注销并重新登录，使更改生效。
配置 ZshZsh 的配置文件位于 ~&#x2F;.zshrc。你可以编辑这个文件来定制 Zsh 的行为。

主题定制Zsh 提供了许多主题可以选择，你可以在 .zshrc 文件中设置 ZSH_THEME 变量来改变主题。一些流行的主题有：


agnoster： ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/posts/gitclone%E6%8C%87%E5%AE%9A%E6%96%87%E4%BB%B6%E5%A4%B9.html" title="gitclone指定文件夹">gitclone指定文件夹</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-04-02T11:45:33.000Z" title="发表于 2024-04-02 19:45:33">2024-04-02</time></span></div><div class="content">gitclone指定文件夹Git Sparse CheckoutGit Sparse Checkout 是一个允许你只检出部分仓库内容的功能。这在你需要仓库的某一部分时非常有用，比如一个大型仓库，但你只需要其中的一小部分。
用法
启用 Sparse Checkout：

1git config core.sparsecheckout true


定义要检出的文件&#x2F;文件夹列表：

123Copy codeecho &quot;path/to/directory/&quot; &gt;&gt; .git/info/sparse-checkoutecho &quot;path/to/file.txt&quot; &gt;&gt; .git/info/sparse-checkout
你可以通过编辑 .git&#x2F;info&#x2F;sparse-checkout 文件来指定要检出的路径。每一行都是一个相对于仓库根目录的路径。

更新工作区：

12git checkout master这个命令将会根据 .git/info/sparse-checkout 文件中指定的路径，更新 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/posts/%E9%A1%B5%E9%9D%A2%E7%BD%AE%E6%8D%A2%E7%AE%97%E6%B3%95.html" title="页面置换算法">页面置换算法</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-03-01T06:01:29.000Z" title="发表于 2024-03-01 14:01:29">2024-03-01</time></span></div><div class="content">页面置换算法最佳页面置换算法（OPT）置换在「未来」最长时间不访问的页面。该算法实现需要计算内存中每个逻辑页面的下次访问时间然后比较，选择未来最长时间不访问的页面
先进先出置换算法（FIFO）选择在内存驻留时间很长的页面进行中置换
最近最久未使用的置换算法（LRU）时钟页面置换算法（Lock）把所有页面都保存在一个类似钟面的环形链表中，表针指向最老的页面。当发生缺页中断时，算法首先检查表针指向的页面：

如果它的访问位是 0 就淘汰该页面并把新页插入这个位置，然后把表针前移一个位置
如果访问位是 1 就清除访问位，并把表针前移一个位置，重复这个过程直到找到了一个访问位为 0 的页面为止

最不常用置换算法（LFU）当发生缺页中断时，选择「访问次数」最少的那个页面并将其淘汰
</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/posts/X%E5%B1%82%E7%BD%91%E7%BB%9C%E6%A8%A1%E5%9E%8B.html" title="X层网络模型">X层网络模型</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-01-16T06:01:29.000Z" title="发表于 2024-01-16 14:01:29">2024-01-16</time></span></div><div class="content">TCP&#x2F;IP四层网络模型：应用HTTP&#x2F;传输TCP UDP&#x2F;网络IP&#x2F;网络接口ARP RARP

ARP：通过IP找MAC地址
RARP：通过网关server的ARP表&#x2F;缓存上请求IP地址
IP：将数据包从源设备传递到目标设备，建立网络连接

OSI七层：应用&#x2F;表示&#x2F;会话&#x2F;传输&#x2F;网络&#x2F;数据链路&#x2F;物理


假设客户端有多个网卡，就会有多个 IP 地址，那 IP 头的源地址应该选择哪个 IP ？
通过路由表（route -n命令），让目的IP地址和每一条目的子网掩码与，如果与Destination IP相同，就将该网卡的IP作为源地址IP。否则走默认网关发送给路由器，目的子网掩码就是路由器IP地址。

</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/posts/TCP%E9%87%8D%E4%BC%A0%E3%80%81%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3%E3%80%81%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6%E3%80%81%E6%8B%A5%E5%A1%9E%E6%8E%A7%E5%88%B6.html" title="TCP重传、滑动窗口、流量控制、拥塞控制">TCP重传、滑动窗口、流量控制、拥塞控制</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-01-15T06:01:29.000Z" title="发表于 2024-01-15 14:01:29">2024-01-15</time></span></div><div class="content">TCP重传、滑动窗口、流量控制、拥塞控制TCP重传机制1、超时重传：数据包丢&#x2F;ACK丢时就会触发超时重传。
2、快速重传：解决超时重发的时间等待。当收到三个相同的 ACK 报文时，会在定时器过期之前，重传丢失的报文段。（问题：重传时是重传一个还是重传所有）
3、SACK：选择性确认。在TCP头「选项」字段里加个 SACK ，它可以将已收到的数据信息发送给「发送方」，这样发送方就可以知道哪些数据收到哪些数据没收，只重传丢失的数据
4、D-SACK：用SACK告诉「发送方」有哪些数据被重复接收（可让发送方知道是发出去的包丢了还是接收方回应 ACK 丢了；可知道是不是发送方的包被网络延迟了；可知道网络中是不是把发送方的包给复制了）
滑动窗口发一次数据等一个ACK，包的往返时间越长通信效率越低。可通过指定窗口大小，在设置窗口大小内无需等待ACK而继续发送数据。
流量控制如果一直无脑发数据但对方处理不来，就导致触发重发机制从而导致网络流量的无端浪费。TCP 提供一种机制让「发送方」根据「接收方」的实际接收能力控制发送的数据量，通过让接收方指明希望从发送方接收的数据大小（窗口大小）来进行 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/posts/TCP%E6%95%85%E9%9A%9C%E5%9C%BA%E6%99%AF.html" title="TCP故障场景">TCP故障场景</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-01-11T06:01:29.000Z" title="发表于 2024-01-11 14:01:29">2024-01-11</time></span></div><div class="content">TCP故障场景TCP连接后一端断电和进程崩溃有什么区别客户端进程崩溃：内核会发送 FIN 与服务端进行四次挥手
客户端主机宕机：（服务端会发送数据）服务端触发超时重传，当重传总间隔时长达到一定阈值后断开 TCP 连接；（服务端不会发送数据）[开启TCP keepalive机制] 服务端在一段时间没有进行数据交互时触发 TCP keepalive 探测对方是否存在，对方已消亡则断开自身TCP连接 [没开] 服务端TCP连接会一直存在且一直保持在 ESTABLISHED已建立状态
拔网线后TCP连接是否存在？有数据传输：客户端拔网线后如果服务端发送数据报文，如果在服务端重传次数没有达到最大之前客户端就插回了网线，那么双方原本的 TCP 连接还能正常存在；否则服务端就会断开 TCP 连接，等客户端插回网线后向服务端发数据，因为服务端已断开与客户端相同四元组的 TCP 连接，所以就会回 RST 报文，客户端收到后就会断开TCP连接
无数据传输：如果双方都没开 TCP keepalive，那么客户端拔网线后如果客户端一直不插回网线，客户端和服务端的TCP连接状态将会一直保持存在；如果双方都开启了 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/posts/count%E6%80%A7%E8%83%BD.html" title="count性能">count性能</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-12-24T06:01:29.000Z" title="发表于 2023-12-24 14:01:29">2023-12-24</time></span></div><div class="content">count性能counit(*) &#x3D; count(1) &gt; count(主键字段) &gt; count(字段)
count(1)、 count(*)、 count(主键字段)执行时，如果表里存在二级索引，优化器就会选择二级索引进行扫描。
所以，如果要执行 count(1)、 count(*)、 count(主键字段) 时，尽量在数据表上建立二级索引，这样优化器会自动采用 key_len 最小的二级索引进行扫描，相比于扫描主键索引效率会高些。
不要使用 count(字段) 来统计记录个数：效率最差，会采用全表扫描的方式来统计。如果你非要统计表中该字段不为NULL的记录个数，建议给这个字段建一个二级索引。
</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/posts/MySQL%E6%89%A7%E8%A1%8C%E4%B8%80%E6%9D%A1update%E8%AF%AD%E5%8F%A5%E4%B8%AD%E9%97%B4%E7%BB%8F%E5%8E%86%E4%BA%86%E4%BB%80%E4%B9%88.html" title="MySQL执行一条update语句中间经历了什么">MySQL执行一条update语句中间经历了什么</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-12-23T06:01:29.000Z" title="发表于 2023-12-23 14:01:29">2023-12-23</time></span></div><div class="content">执行一条update语句中间经历了什么 UPDATE t_user SET name = &#39;xiaolin&#39; WHERE id = 1; 

执行器负责具体执行，调用存储引擎接口，通过主键索引树搜索获取id&#x3D;1这一行记录：
如果 id&#x3D;1 这一行所在的数据页本来就在 buffer pool 中，就直接返回给执行器更新；
如果记录不在 buffer pool，将数据页从磁盘读入到 buffer pool，返回记录给执行器。


执行器得到聚簇索引记录后，会看一下更新前记录和更新后记录是否一样：
如果一样的话就不进行后续更新流程；
如果不一样的话就把更新前的记录和更新后的记录都当作参数传给 InnoDB 层，让 InnoDB 真正的执行更新记录的操作；


开启事务， InnoDB层更新记录前，首先要记录相应的 undo log，因为这是更新操作，需要把被更新的列的旧值记下来，也就是要生成一条 undo log，undo log 会写入 Buffer Pool 中的 Undo 页面，不过在内存修改该 Undo 页面后，需要记录对应的 redo log。
 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/posts/MySQL%E6%89%A7%E8%A1%8C%E4%B8%80%E6%9D%A1select%E8%AF%AD%E5%8F%A5%E6%9C%9F%E9%97%B4%E5%8F%91%E7%94%9F%E4%BA%86%E4%BB%80%E4%B9%88.html" title="MySQL执行一条select语句期间发生了什么">MySQL执行一条select语句期间发生了什么</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-12-04T06:01:29.000Z" title="发表于 2023-12-04 14:01:29">2023-12-04</time></span></div><div class="content">执行一条select语句期间发生了什么MySQL分为Server层和存储引擎层。Server层负责建立连接、分析和执行 SQL，存储引擎层负责数据的存储和提取（支持InnoDB、MyISAM、Memory等多个存储引擎，不同的存储引擎共用一个Server 层）
1、连接器：首先经过TCP三次握手连接MySQL服务，连接器开始验证用户名和密码，读取权限

show processlist查看MySQL服务被多少个客户端连接

2、查询缓存（8.0后删除）：SQL语句如果是select语句，就会先去查询缓存看看之前是否执行过（kv形式存内存）。对于更新频繁的表查询缓存命中率低，一个表有更新操作那么这个表的查询缓存就会被清空，鸡肋。
3、解析SQL：解析器进行词法分析，语法分析，没问题就构建SQL语法树
4、执行SQL：预处理阶段（检查SQL语句中的表或字段是否存在，将 select * 中的 * 扩展为表上所有列）优化阶段（负责将 SQL 语句执行方案确定下来，语句前+explain可以输出SQL语句的执行计划）执行阶段（执行器和存储引擎交互，交互以记录为单位，从存储引擎读取记录，返回给客 ...</div></div></div><nav id="pagination"><div class="pagination"><span class="page-number current">1</span><a class="page-number" href="/page/2/#content-inner">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/#content-inner">5</a><a class="extend next" rel="next" href="/page/2/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://p3-pc.douyinpic.com/img/aweme-avatar/tos-cn-i-0813c001_oQVMIAnrIBEDAAPZbBAAQEAelfjxNss2b6F7Ef~c5_300x300.jpeg?from=2956013662" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">dyx</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">46</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">15</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/dangyuxin"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/dangyuxin" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="https://www.douyin.com/user/MS4wLjABAAAAabKSuqKzuKHByiNDDVLzJrbfB-5yw67yU4_9_9HcEjM" target="_blank" title="Douyin"><i class="fab fa-tiktok" style="color: #24292e;"></i></a><a class="social-icon" href="https://space.bilibili.com/173312348?spm_id_from=333.337.0.0" target="_blank" title="Bilibili"><i class="fab fa-bilibili" style="color: #24292e;"></i></a></div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/docker%E4%BD%BF%E7%94%A8%E4%B8%8E%E9%85%8D%E7%BD%AE.html" title="docker使用与配置">docker使用与配置</a><time datetime="2024-04-16T11:45:33.000Z" title="发表于 2024-04-16 19:45:33">2024-04-16</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/%E5%A6%82%E4%BD%95%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8%20Zsh.html" title="如何安装和使用 Zsh">如何安装和使用 Zsh</a><time datetime="2024-04-11T11:45:33.000Z" title="发表于 2024-04-11 19:45:33">2024-04-11</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/gitclone%E6%8C%87%E5%AE%9A%E6%96%87%E4%BB%B6%E5%A4%B9.html" title="gitclone指定文件夹">gitclone指定文件夹</a><time datetime="2024-04-02T11:45:33.000Z" title="发表于 2024-04-02 19:45:33">2024-04-02</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/%E9%A1%B5%E9%9D%A2%E7%BD%AE%E6%8D%A2%E7%AE%97%E6%B3%95.html" title="页面置换算法">页面置换算法</a><time datetime="2024-03-01T06:01:29.000Z" title="发表于 2024-03-01 14:01:29">2024-03-01</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/X%E5%B1%82%E7%BD%91%E7%BB%9C%E6%A8%A1%E5%9E%8B.html" title="X层网络模型">X层网络模型</a><time datetime="2024-01-16T06:01:29.000Z" title="发表于 2024-01-16 14:01:29">2024-01-16</time></div></div></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>分类</span>
            
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/MySQL/"><span class="card-category-list-name">MySQL</span><span class="card-category-list-count">10</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Redis/"><span class="card-category-list-name">Redis</span><span class="card-category-list-count">8</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E5%B7%A5%E5%85%B7%E5%AD%A6%E4%B9%A0/"><span class="card-category-list-name">工具学习</span><span class="card-category-list-count">4</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"><span class="card-category-list-name">操作系统</span><span class="card-category-list-count">13</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E7%BC%96%E7%A8%8B/"><span class="card-category-list-name">编程</span><span class="card-category-list-count">3</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E7%BD%91%E7%BB%9C/"><span class="card-category-list-name">网络</span><span class="card-category-list-count">7</span></a></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/MySQL%E4%BA%8B%E5%8A%A1/" style="font-size: 1.1em; color: #999">MySQL事务</a> <a href="/tags/Linux/" style="font-size: 1.5em; color: #99a9bf">Linux</a> <a href="/tags/Linux%E7%B3%BB%E7%BB%9F%E7%BC%96%E7%A8%8B/" style="font-size: 1.37em; color: #99a4b2">Linux系统编程</a> <a href="/tags/docker/" style="font-size: 1.1em; color: #999">docker</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 1.23em; color: #999ea6">算法</a> <a href="/tags/zsh/" style="font-size: 1.1em; color: #999">zsh</a> <a href="/tags/github/" style="font-size: 1.23em; color: #999ea6">github</a> <a href="/tags/git/" style="font-size: 1.23em; color: #999ea6">git</a> <a href="/tags/%E9%94%81/" style="font-size: 1.23em; color: #999ea6">锁</a> <a href="/tags/C%E8%AF%AD%E8%A8%80/" style="font-size: 1.37em; color: #99a4b2">C语言</a> <a href="/tags/%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/" style="font-size: 1.1em; color: #999">内存管理</a> <a href="/tags/MySQL%E6%97%A5%E5%BF%97/" style="font-size: 1.23em; color: #999ea6">MySQL日志</a> <a href="/tags/B-%E6%A0%91/" style="font-size: 1.1em; color: #999">B+树</a> <a href="/tags/%E9%9B%B6%E6%8B%B7%E8%B4%9D/" style="font-size: 1.1em; color: #999">零拷贝</a> <a href="/tags/MySQL/" style="font-size: 1.1em; color: #999">MySQL</a></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span><a class="card-more-btn" href="/archives/" title="查看更多">
    <i class="fas fa-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/04/"><span class="card-archive-list-date">四月 2024</span><span class="card-archive-list-count">3</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/03/"><span class="card-archive-list-date">三月 2024</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/01/"><span class="card-archive-list-date">一月 2024</span><span class="card-archive-list-count">3</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/12/"><span class="card-archive-list-date">十二月 2023</span><span class="card-archive-list-count">3</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/11/"><span class="card-archive-list-date">十一月 2023</span><span class="card-archive-list-count">5</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/10/"><span class="card-archive-list-date">十月 2023</span><span class="card-archive-list-count">4</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/09/"><span class="card-archive-list-date">九月 2023</span><span class="card-archive-list-count">3</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/08/"><span class="card-archive-list-date">八月 2023</span><span class="card-archive-list-count">9</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">46</div></div><div class="webinfo-item"><div class="item-name">本站总字数 :</div><div class="item-count">45.3k</div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2024-05-12T06:21:27.275Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://dyx-bucket.oss-cn-beijing.aliyuncs.com/2e339a3a385a4fcb89e102016eb40b61.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2024 By dyx</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="/js/tw_cn.js?v=4.13.0"></script><script src="/pluginsSrc/@fancyapps/ui/dist/fancybox/fancybox.umd.js?v=5.0.33"></script><div class="js-pjax"><script>window.typedJSFn = {
  init: (str) => {
    window.typed = new Typed('#subtitle', Object.assign({
      strings: str,
      startDelay: 300,
      typeSpeed: 150,
      loop: true,
      backSpeed: 50,
    }, null))
  },
  run: (subtitleType) => {
    if (true) {
      if (typeof Typed === 'function') {
        subtitleType()
      } else {
        getScript('/pluginsSrc/typed.js/dist/typed.umd.js?v=2.1.0').then(subtitleType)
      }
    } else {
      subtitleType()
    }
  }
}
</script><script>function subtitleType () {
  if (true) {
    typedJSFn.init(["今日事&#44;今日毕","学会与自己和解","怀古莫要伤今，行走世间，本就是一种积累"])
  } else {
    document.getElementById("subtitle").textContent = "今日事&#44;今日毕"
  }
}
typedJSFn.run(subtitleType)</script></div><script defer="defer" id="fluttering_ribbon" mobile="true" src="/pluginsSrc/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js?v=1.1.3"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="/pluginsSrc/butterfly-extsrc/dist/canvas-nest.min.js?v=1.1.3"></script><script id="click-heart" src="/pluginsSrc/butterfly-extsrc/dist/click-heart.min.js?v=1.1.3" async="async" mobile="true"></script><script src="/pluginsSrc/pjax/pjax.min.js?v=0.2.8"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener
  btf.removeGlobalFnEvent('pjax')
  btf.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script></div></body></html>